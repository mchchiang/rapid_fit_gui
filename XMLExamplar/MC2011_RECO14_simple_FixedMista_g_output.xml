<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<RapidFit>
    <ParameterSet>
        <PhysicsParameter>
            <Name>F_s</Name>
            <Value>0.0</Value>
            <Minimum>0.0</Minimum>
            <Maximum>0.5</Maximum>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_s</Name>
            <Value>0.88</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Csp</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>gamma</Name>
            <Value>0.66</Value>
            <Minimum>0.6</Minimum>
            <Maximum>0.75</Maximum>
            <Type>Free</Type>
            <Unit>ps^{-1}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>deltaGamma</Name>
            <Value>0.09</Value>
            <Minimum>0.01</Minimum>
            <Maximum>0.18</Maximum>
            <Type>Free</Type>
            <Unit>ps^{-1}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Aperp_sq</Name>
            <Value>0.15</Value>
            <Minimum>0.0</Minimum>
            <Maximum>0.5</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Azero_sq</Name>
            <Value>0.59</Value>
            <Minimum>0.0</Minimum>
            <Maximum>0.8</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_para</Name>
            <Value>2.4</Value>
            <Minimum>-6.3</Minimum>
            <Maximum>6.3</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
            <StepSize>0.05</StepSize>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_perp</Name>
            <Value>-0.2</Value>
            <Minimum>-6.3</Minimum>
            <Maximum>6.3</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
            <StepSize>0.05</StepSize>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_zero</Name>
            <Value>0.0</Value>
            <Minimum>-3.3</Minimum>
            <Maximum>3.3</Maximum>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>deltaM</Name>
            <Value>17.7655</Value>
            <Type>Free</Type>
            <Unit>ps-1</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Phi_s</Name>
            <Value>-0.035</Value>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>lambda</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeResolutionScale</Name>
            <Value>1.8</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagP1_OS</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagP0_OS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagSetPoint_OS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaP1_OS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaP0_OS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaSetPoint_OS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagP1_SS</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagP0_SS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagSetPoint_SS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaP1_SS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaP0_SS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagDeltaSetPoint_SS</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>beta</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
    </ParameterSet>
    <Minimiser>
        <MinimiserName>Minuit</MinimiserName>
        <MaxSteps>100000</MaxSteps>
        <GradTolerance>0.01</GradTolerance>
        <ConfigureMinimiser>NoHesse</ConfigureMinimiser>
        <Quality>0</Quality>
    </Minimiser>
    <FitFunction>
        <FunctionName>NegativeLogLikelihoodThreaded</FunctionName>
        <WeightName>sWeight</WeightName>
        <Threads>16</Threads>
        <SetIntegratorTest>False</SetIntegratorTest>
        <NormaliseWeights>True</NormaliseWeights>
        <OffSetNLL>True</OffSetNLL>
    </FitFunction>
    <NumberRepeats>1</NumberRepeats>
    <CommonPhaseSpace>
        <PhaseSpaceBoundary>
            <Observable>
                <Name>time</Name>
                <Minimum>0.3</Minimum>
                <Maximum>14.0</Maximum>
                <Unit>ps</Unit>
            </Observable>
            <Observable>
                <Name>helcosthetaK</Name>
                <Minimum>-1.0</Minimum>
                <Maximum>1.0</Maximum>
                <Unit> </Unit>
            </Observable>
            <Observable>
                <Name>helphi</Name>
                <Minimum>-3.1416</Minimum>
                <Maximum>3.1416</Maximum>
                <Unit>rad</Unit>
                <TF1>(helphi+TMath::Pi()-(helphi&gt;0.)*(2.*TMath::Pi()))</TF1>
            </Observable>
            <Observable>
                <Name>helcosthetaL</Name>
                <Minimum>-1.0</Minimum>
                <Maximum>1.0</Maximum>
                <Unit> </Unit>
            </Observable>
            <Observable>
                <Name>tagdecision_os</Name>
                <Value>1.0</Value>
                <Value>0.0</Value>
                <Value>-1.0</Value>
                <Unit> </Unit>
                <TF1>tagdecision_os_cb</TF1>
            </Observable>
            <Observable>
                <Name>tagdecision_ss</Name>
                <Value>1.0</Value>
                <Value>0.0</Value>
                <Value>-1.0</Value>
                <Unit> </Unit>
                <TF1>tagdecision_ss_nn</TF1>
            </Observable>
            <Observable>
                <Name>tagomega_os</Name>
                <Minimum>0.0</Minimum>
                <Maximum>0.5</Maximum>
                <Unit> </Unit>
                <TF1>tagomega_os_cb</TF1>
            </Observable>
            <Observable>
                <Name>tagomega_ss</Name>
                <Minimum>0.0</Minimum>
                <Maximum>0.5</Maximum>
                <Unit> </Unit>
                <TF1>tagomega_ss_nn</TF1>
            </Observable>
            <Observable>
                <Name>eventResolution</Name>
                <Minimum>0.0</Minimum>
                <Maximum>0.12</Maximum>
                <Unit> </Unit>
                <TF1>sigmat</TF1>
            </Observable>
            <Observable>
                <Name>sWeight</Name>
                <Minimum>-100000.0</Minimum>
                <Maximum>100000.0</Maximum>
                <Unit> </Unit>
                <TF1>track_weight</TF1>
            </Observable>
            <Observable>
                <Name>unbiased</Name>
                <Value>0.0</Value>
                <Value>1.0</Value>
                <Unit> </Unit>
                <TF1>triggerDecisionUnbiased</TF1>
            </Observable>
            <Observable>
                <Name>biased</Name>
                <Value>0.0</Value>
                <Value>1.0</Value>
                <Unit> </Unit>
                <TF1>triggerDecisionBiasedExcl</TF1>
            </Observable>
        </PhaseSpaceBoundary>
    </CommonPhaseSpace>
    <CommonPDF>
        <PDF>
            <Name>Bs2JpsiPhi_Signal_v8</Name>
            <ConfigurationParameter>UseHelicityBasis:True</ConfigurationParameter>
            <ConfigurationParameter>AngularAcceptanceFile:2014-3fbAnalysis/angAccWeights_psi2s_2011.root</ConfigurationParameter>
            <ConfigurationParameter>AngularAcceptanceIgnoreNumerator:True</ConfigurationParameter>
            <ConfigurationParameter>UseTimeAcceptance:True</ConfigurationParameter>
            <ConfigurationParameter>UseEventResolution:True</ConfigurationParameter>
            <ConfigurationParameter>useNewMistagModel:True</ConfigurationParameter>
            <ConfigurationParameter>ResolutionModel:ResolutionModel</ConfigurationParameter>
            <ConfigurationParameter>useMultiplePhis:False</ConfigurationParameter>
        </PDF>
    </CommonPDF>
    <Precalculator/>
    <ToFit>
        <CommonPDF>True</CommonPDF>
        <PDFConfigurator>
            <ConfigurationParameter>TimeAcceptanceFile:2014-3fbAnalysis/time_acc_unbiased_2011.txt</ConfigurationParameter>
        </PDFConfigurator>
        <DataSet>
            <Source>File</Source>
            <CutString>triggerDecisionUnbiased==1&&bkgcat==0</CutString>
            <FileName>$HOME/Bs2Psi2SPhi/fit/data_files/MC2011_psi2s_output_weight.root</FileName>
            <NumberEvents>1000000000</NumberEvents>
            <CommonPhaseSpace/>
        </DataSet>
    </ToFit>
    <ToFit>
        <CommonPDF>True</CommonPDF>
        <PDFConfigurator>
            <ConfigurationParameter>TimeAcceptanceFile:2014-3fbAnalysis/time_acc_biased_2011.txt</ConfigurationParameter>
        </PDFConfigurator>
        <DataSet>
            <Source>File</Source>
            <CutString>triggerDecisionBiasedExcl==1&&bkgcat==0</CutString>
            <FileName>$HOME/Bs2Psi2SPhi/fit/data_files/MC2011_psi2s_output_weight.root</FileName>
            <NumberEvents>1000000000</NumberEvents>
            <CommonPhaseSpace/>
        </DataSet>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>deltaM</Name>
                <Value>17.768</Value>
                <Error>0.024</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagP1_OS</Name>
                <Value>0.982</Value>
                <Error>0.035</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagP0_OS</Name>
                <Value>0.0062</Value>
                <Error>0.0044</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagDeltaP0_OS</Name>
                <Value>0.014</Value>
                <Error>0.0012</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagDeltaP1_OS</Name>
                <Value>0.066</Value>
                <Error>0.012</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagP1_SS</Name>
                <Value>0.976</Value>
                <Error>0.18</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagP0_SS</Name>
                <Value>0.005</Value>
                <Error>0.005</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagDeltaP0_SS</Name>
                <Value>-0.0158</Value>
                <Error>0.0014</Error>
            </ExternalConstraint>
            <ExternalConstraint>
                <Name>mistagDeltaP1_SS</Name>
                <Value>0.007</Value>
                <Error>0.0111</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <Output/>
</RapidFit>
