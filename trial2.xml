<RapidFit>
    <ParameterSet>
        <PhysicsParameter>
            <Name>SignalFractionUBT</Name>
            <Value>0.80</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>SignalFractionUBU</Name>
            <Value>0.72</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>gamma</Name>
            <Value>0.7</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.5</Maximum>
            <Type>Free</Type>
            <Unit>ps^{-1}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>deltaGamma</Name>
            <Value>0.0 </Value>
            <Minimum>-1.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Free</Type>
            <Unit>ps^{-1}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Aperp_sq</Name>
            <Value>0.16</Value>
            <Minimum>0.0</Minimum>
            <Maximum>0.5</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Azero_sq</Name>
            <Value>0.60</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>As_sq</Name>
            <Value>0.00</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_para</Name>
            <Value>3.2</Value>
            <Minimum>-6.3</Minimum>
            <Maximum>6.6</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_perp</Name>
            <Value>-0.17</Value>
            <Minimum>-6.3</Minimum>
            <Maximum>6.3</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_zero</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>delta_s</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>deltaM</Name>
            <Value>17.3</Value>
            <Type>Free</Type>
            <Unit>MeV/c2</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>Phi_s</Name>
            <BlindString>BsGoofy</BlindString>
            <BlindScale>0.0</BlindScale>
            <Value>0.0</Value>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>f_sig_m1</Name>
            <Value>1.0</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.00001</Maximum>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>sigma_m1</Name>
            <Value>7.51</Value>
            <Minimum>0.0</Minimum>
            <Maximum>20.0</Maximum>
            <Type>Fixed</Type>
            <Unit>MeV/c^{2}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>sigma_m2</Name>
            <Value>20.0</Value>
            <Minimum>10.0</Minimum>
            <Maximum>100.0</Maximum>
            <Type>Fixed</Type>
            <Unit>MeV/c^{2}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>m_Bs</Name>
            <Value>5366.4</Value>
            <Type>Fixed</Type>
            <Unit>MeV/c^{2}</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagScale</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>mistagOffset</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit> </Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeResolution1Fraction</Name>
            <Value>0.64</Value>
            <Minimum>0.5</Minimum>
            <Maximum>1.1</Maximum>
            <Type>Fixed</Type>
            <Unit>unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeResolution1</Name>
            <Value>0.0337</Value>
            <Minimum>-0.0000001</Minimum>
            <Maximum>0.100</Maximum>
            <Type>Fixed</Type>
            <Unit>ps</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeResolution2</Name>
            <Value>0.0646</Value>
            <Minimum>-0.00000001</Minimum>
            <Maximum>0.500</Maximum>
            <Type>Fixed</Type>
            <Unit>ps</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeOffset</Name>
            <Value>0.000</Value>
            <Minimum>-0.1</Minimum>
            <Maximum>0.1</Maximum>
            <Type>Fixed</Type>
            <Unit>ps</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI1</Name>
            <Value>0.983695</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI2</Name>
            <Value>1.02313</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI3</Name>
            <Value>1.02428</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI4</Name>
            <Value>-0.000087511</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI5</Name>
            <Value>-0.000130425</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI6</Name>
            <Value>0.00646512</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI7</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI8</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI9</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>angAccI10</Name>
            <Value>0.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>f_LL1</Name>
            <Value>0.992</Value>
            <Minimum>0.0</Minimum>
            <Maximum>1.0</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>tau_LL1</Name>
            <Value>0.131</Value>
            <Minimum>0.01</Minimum>
            <Maximum>0.5</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>tau_LL2</Name>
            <Value>0.876</Value>
            <Minimum>0.05</Minimum>
            <Maximum>1.5</Maximum>
            <Type>Free</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>alphaM_pr</Name>
            <Value>0.00094</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>timeResLL1Frac</Name>
            <Value>1.0</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>sigma_LL1</Name>
            <Value>0.00</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
        <PhysicsParameter>
            <Name>sigma_LL2</Name>
            <Value>0.00</Value>
            <Type>Fixed</Type>
            <Unit>Unitless</Unit>
        </PhysicsParameter>
    </ParameterSet>
    <Minimiser>
		<MinimiserName>Minuit</MinimiserName>
		<MaxSteps>100000</MaxSteps>
		<GradTolerance>0.0001</GradTolerance>
		<Quality>0</Quality>
		<ConfigureMinimiser>MinosErrors</ConfigureMinimiser>
	</Minimiser>
	<FitFunction>
		<AlphaName>alpha</AlphaName>
		<WeightName>sWeight</WeightName>
		<FunctionName>NegativeLogLikelihoodThreaded</FunctionName>
		<Threads>16</Threads>
		<UseGSLNumericalIntegration>true</UseGSLNumericalIntegration>
		<FixedIntegrationPoints>1000000</FixedIntegrationPoints>
		<SetIntegratorTest>false</SetIntegratorTest>
		<NormaliseWeights>true</NormaliseWeights>
		<Strategy>Petes</Strategy>
	</FitFunction>
	<Precalculator>
		<UseAlpha>true</UseAlpha>
	</Precalculator>
	<CommonPDF>
		<ProdPDF>
            <FractionName>SignalFractionUBT</FractionName>
            <ProdPDF>
                <PDF>
                    <Name>Bs2JpsiPhi_SignalAlt_MO_v1</Name>  
                </PDF>
                <PDF>
                    <Name>Bs2JpsiPhiMassSignal</Name>
                </PDF>
            </ProdPDF>
            <NormalisedSumPDF>
	            <FractionName>SignalFractionUBT</FractionName>
	            <ProdPDF>
	                <PDF>
	                    <Name>Bs2JpsiPhi_SignalAlt_MO_v1</Name>  
	                    <ConfigurationParameter>UseHelicityBasis:True</ConfigurationParameter>
	                    <ConfigurationParameter>UseTimeAcceptance:True</ConfigurationParameter>
	                    <ConfigurationParameter>TimeAcceptanceFile:Jpsifzero-signal-1fb-v2.txt</ConfigurationParameter>
	                    <ConfigurationParameter>UseEventResolution:True</ConfigurationParameter>
	                </PDF>
	                <PDF>
	                    <Name>Bs2JpsiPhiMassSignal</Name>
	                </PDF>
	            </ProdPDF>
	            <ProdPDF>
	                <PDF>
	                    <Name>Bs2JpsiPhiLongLivedBkg_withTimeRes</Name>
	                </PDF>
	                <PDF>
	                    <Name>Bs2JpsiPhiMassBkg</Name>
	                </PDF>
	            </ProdPDF>
        	</NormalisedSumPDF>
        </ProdPDF>
	</CommonPDF>
    <CommonPhaseSpace>
		<PhaseSpaceBoundary>
			<Observable>
				<Name>time</Name>
				<Minimum>0.3</Minimum>
				<Maximum>14.0</Maximum>
				<Unit>ps</Unit>
			</Observable>
			<Observable>
				<Name>helcosthetaK</Name>
				<Minimum>-1.0</Minimum>
				<Maximum>1.0</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>helphi</Name>
				<TF1>(helphi+TMath::Pi()-(helphi>0.)*(2.*TMath::Pi()))</TF1>
				<Minimum>-3.1416</Minimum>
				<Maximum>3.1416</Maximum>
				<Unit>rad</Unit>
			</Observable>
			<Observable>
				<Name>helcosthetaL</Name>
				<Minimum>-1.0</Minimum>
				<Maximum>1.0</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>tagdecision_os</Name>
				<TF1>tagdecision_os_cb</TF1>
				<Value>1.</Value>
				<Value>0.</Value>
				<Value>-1.</Value>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>tagdecision_ss</Name>
				<TF1>tagdecision_ss_nn</TF1>
				<Value>1.</Value>
				<Value>0.</Value>
				<Value>-1.</Value>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>tagomega_os</Name>
				<TF1>tagomega_os_cb</TF1>
				<Minimum>0.</Minimum>
				<Maximum>0.5</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>tagomega_ss</Name>
				<TF1>tagomega_ss_nn</TF1>
				<Minimum>0.</Minimum>
				<Maximum>0.5</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>eventResolution</Name>
				<TF1>sigmat</TF1>
				<Minimum>0.0</Minimum>
				<Maximum>0.12</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>sWeight</Name>
				<TF1>sWeights_ipatia</TF1>
				<Minimum>-10</Minimum>
				<Maximum>10</Maximum>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>runPeriod</Name>
				<Value>2011</Value>
				<Unit> </Unit>
			</Observable>
			<Observable>
				<Name>hlt1_excl_biased_dec</Name>
				<Value>0.0</Value>
				<Value>1.0</Value>
				<Unit> </Unit>
			</Observable>
		</PhaseSpaceBoundary>
	</CommonPhaseSpace>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>deltaM</Name>
                <Value>17.63</Value>
                <Error>0.11</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>timeResolutionScale</Name>
                <Value>1.0</Value>
                <Error>0.02</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagP1_OS</Name>
                <Value>1.000</Value>
                <Error>0.023</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagP0_OS</Name>
                <Value>0.392</Value>
                <Error>0.008</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagDeltaP0_OS</Name>
                <Value>0.011</Value>
                <Error>0.0034</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagP1_SS</Name>
                <Value>1.000</Value>
                <Error>0.14</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagP0_SS</Name>
                <Value>0.350</Value>
                <Error>0.017</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagDeltaP0_SS</Name>
                <Value>-0.019</Value>
                <Error>0.005</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagP0_OSSS</Name>
                <Value>0.000</Value>
                <Error>0.025</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>mistagDeltaP0_OSSS</Name>
                <Value>-0.011</Value>
                <Error>0.004</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
    <ToFit>
        <ConstraintFunction>
            <ExternalConstraint>
                <Name>SpecialForGreig</Name>
                <Value>0.0</Value>
                <Error>0.</Error>
            </ExternalConstraint>
        </ConstraintFunction>
    </ToFit>
</RapidFit>
